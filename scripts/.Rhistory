names(pot_data) <- make.names(names(pot_data), unique = TRUE)
pot_dat <- read.csv(file = "../data/ADFG_SE_AK_pot_surveys/Pot_Set_Data_for_Tanner_and_RKC_surveys.csv")
# Remove spaces from column names
names(pot_dat) <- make.names(names(pot_dat), unique = TRUE)
View(pot_dat)
# Eliminate columns we don't care about
pot_dat <- pot_dat %>%
select(-c(Pot.Dimension.Feet, Pot.Escape.Device, Bait.Method, Weight.Of.Pot.Pounds,
Pot.Type, Substrate.Type, Debris.Type))
# Change name of Tidbit ID column to match the one in use for tidbit_data
pot_dat <- rename(pot_dat, tidbit_id = Tidbit.No)
# Convert format of time columns from character to date
pot_dat$Time.Hauled <- mdy_hm(pot_dat$Time.Hauled, tz = "US/Alaska")
pot_dat$Time.Set <- mdy_hm(pot_dat$Time.Set, tz = "US/Alaska")
# Check on frequency of tidbits
table(pot_dat$Year, pot_dat$tidbit_id)
# Remove years before 2005 (first year with tidbits)
test <- pot_dat %>%
filter(Year > 2004)
View(test)
# Remove years before 2005 (first year with tidbits)
test <- pot_dat %>%
filter(Year >= 2005)
# Remove years before 2005 (first year with tidbits)
pot_dat <- pot_dat %>%
filter(Year >= 2005)
# Check on frequency of tidbits
table(pot_dat$Year, pot_dat$tidbit_id)
View(pot_dat)
# Check on frequency of tidbits
table(pot_dat$Year, pot_dat$tidbit_id)
# Check on frequency of tidbits
table(pot_dat$Year, pot_dat$tidbit_id, pot_dat$Project)
# Filter pot data to only include info from 2005 surveys
ohfive_pot_dat <- pot_dat %>%
filter(Year == "2005")
# Create version of pot_dat that only has years with tidbit_id info
full_pot_dat <- pot_dat %>%
filter(Year >= "2007")
# Create version of pot_dat that only has years with tidbit_id info
full_pot_dat <- pot_dat %>%
filter(Year >= 2007)
# Filter pot data to only include info from 2005 surveys
ohfive_pot_dat <- pot_dat %>%
filter(Year == 2005)
tidbit_pots <- ohfive_pot_dat %>%
filter(grepl("Tidbit", Pot.Comment, ignore.case = TRUE))
# Check we got all tidbit pots by looking at comments that don't match
non_tidbit_pots <- ohfive_pot_dat %>%
filter(!grepl("Tidbit", Pot.Comment, ignore.case = TRUE))
View(non_tidbit_pots)
# Get all from single-digit tidbits
tidbit_pots$tidbit_id <- str_extract(tidbit_pots$Pot.Comment, "#.")
# Overwrite single-digits that should be double-digits without adding NAs
# (prev. command read, say, #12 as #1)
new_dig <- str_extract(tidbit_pots$Pot.Comment, "#.\\d")
for (i in 1:length(new_dig)){
if (!is.na(new_dig[i])){
tidbit_pots$tidbit_id[i] <- new_dig[i]
}
else{}
}
# Remove the # from the column
tidbit_pots$tidbit_id <- gsub("#", "", tidbit_pots$tidbit_id)
# Remove the # from the column
tidbit_pots$tidbit_id <- gsub("#", "", tidbit_pots$tidbit_id)
# We still have a few left, but we can just add these manually
tidbit_pots[grep("5 Tidbit", tidbit_pots$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "5"
tidbit_pots[grep("11 Tidbit", tidbit_pots$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "11"
tidbit_pots[grep("10 Tidbit", tidbit_pots$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "10"
tidbit_pots[grep("7 Tidbit", tidbit_pots$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "7"
tidbit_pots[tidbit_pots$Pot.Comment == "Tidbit # 10 on this pot.", ]$tidbit_id <- "10"
tidbit_pots[tidbit_pots$Pot.Comment == "Tidbit 11 on this pot.", ]$tidbit_id <- "11"
# Alright, verify we did a good job here
any(is.na(tidbit_pots$tidbit_id))
tidbit_pots[grep("10 Tidbit", tidbit_pots$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "10"
table(tidbit_pots$tidbit_id)
# Now we'll remerge the tidbit and non-tidbit pots to recreate the full 2005 dataset. It'll look the same, just with the Tidbit info added from the comments
ohfive_pot_dat <- rbind(tidbit_pots, non_tidbit_pots)
# Filter pot data to only include info from 2006 surveys
ohsix_pot_dat <- pot_dat %>%
filter(Year == 2006)
ohsix_pot_dat
View(ohsix_pot_dat)
tidbit_pots <- ohsix_pot_dat %>%
filter(grepl("Tidbit", Pot.Comment, ignore.case = TRUE))
# Check we got all tidbit pots by looking at comments that don't match
non_tidbit_pots <- ohsix_pot_dat %>%
filter(!grepl("Tidbit", Pot.Comment, ignore.case = TRUE))
View(non_tidbit_pots)
View(ohsix_pot_dat)
# Get all from single-digit tidbits
tidbit_pots$tidbit_id <- str_extract(tidbit_pots$Pot.Comment, "#.")
# Overwrite single-digits that should be double-digits without adding NAs
# (prev. command read, say, #12 as #1)
new_dig <- str_extract(tidbit_pots$Pot.Comment, "#.\\d")
for (i in 1:length(new_dig)){
if (!is.na(new_dig[i])){
tidbit_pots$tidbit_id[i] <- new_dig[i]
}
else{}
}
# Remove the # from the column
tidbit_pots$tidbit_id <- gsub("#", "", tidbit_pots$tidbit_id)
View(tidbit_pots)
View(fix_longhead_txt)
new_dig
View(ohsix_pot_dat)
ohsix_pot_dat <- pot_dat %>%
filter(Year == 2006)
tidbit_pots <- ohsix_pot_dat %>%
filter(grepl("Tidbit", Pot.Comment, ignore.case = TRUE))
# Check we got all tidbit pots by looking at comments that don't match
non_tidbit_pots <- ohsix_pot_dat %>%
filter(!grepl("Tidbit", Pot.Comment, ignore.case = TRUE))
# Yep, looks like tidbit_pots contains all 2005 tidbit pots!
# Now we need to extract the tidbit number
# In most, it's after a #
# Get all from single-digit tidbits
tidbit_pots$tidbit_id <- str_extract(tidbit_pots$Pot.Comment, "#.")
# Overwrite single-digits that should be double-digits without adding NAs
# (prev. command read, say, #12 as #1)
new_dig <- str_extract(tidbit_pots$Pot.Comment, "#.\\d")
for (i in 1:length(new_dig)){
if (!is.na(new_dig[i])){
tidbit_pots$tidbit_id[i] <- new_dig[i]
}
else{}
}
# Remove the # from the column
tidbit_pots$tidbit_id <- gsub("#", "", tidbit_pots$tidbit_id)
View(tidbit_pots)
View(non_tidbit_pots)
# For most, the tidbit number is after an "#", so we'll just extract that.
new_dig <- str_extract(tidbit_pots$Pot.Comment, "#.\\d{1:2}")
# Overwrite single-digits that should be double-digits without adding NAs
# (prev. command read, say, #12 as #1)
new_dig <- str_extract(tidbit_pots$Pot.Comment, "#.\\d{1,2}")
# Overwrite single-digits that should be double-digits without adding NAs
# (prev. command read, say, #12 as #1)
tidbit_pots$tidbit_id <- str_extract(tidbit_pots$Pot.Comment, "#.\\d{1,2}")
rm tidbit_pots
?remove
rm(tidbit_pots)
rm(non_tidbit_pots)
rm(test)
ohsix_pot_dat <- pot_dat %>%
filter(Year == 2006)
# For most, the tidbit number is after an "#", so we'll just extract that.
ohsix_pot_dat$tidbit_id <- str_extract(ohsix_pot_dat$Pot.Comment, "#.\\d{1:2}")
# For most, the tidbit number is after an "#", so we'll just extract that.
ohsix_pot_dat$tidbit_id <- str_extract(ohsix_pot_dat$Pot.Comment, "#.\\d{1,2}")
View(ohsix_pot_dat)
# For most, the tidbit number is after an "#", so we'll just extract that.
ohsix_pot_dat$tidbit_id <- str_extract(ohsix_pot_dat$Pot.Comment, "#\\d{1,2}")
View(ohsix_pot_dat)
# For others, the tidbit number is just after "Tidbit", so we'll extract that too
new_digs <- str_extract(ohsix_pot_dat$Pot.Comment, "idbit \\d{1,2}")
new_digs
str_extract
?str_extra
?str_extract
new_digs <- str_extract((new_digs, "\\d{1,2}"))
new_digs <- str_extract(new_digs, "\\d{1,2}")
new_digs
ohsix_pot_dat$tidbit_id[i] <- new_digs[i]
ohsix_pot_dat <- pot_dat %>%
filter(Year == 2006)
# For most, the tidbit number is after an "#", so we'll just extract that.
ohsix_pot_dat$tidbit_id <- str_extract(ohsix_pot_dat$Pot.Comment, "#\\d{1,2}")
# For others, the tidbit number is just after "Tidbit", so we'll extract that too
new_digs <- str_extract(ohsix_pot_dat$Pot.Comment, "idbit \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohsix_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
View(ohsix_pot_dat)
# For a few more, the tidbit number is after an "# " (ex: "Tidbit # 19"), so we'll extract that too
new_digs <- str_extract(ohsix_pot_dat$Pot.Comment, "# \\d{1,2}")
new_digs
new_digs <- str_extract(new_digs, "\\d{1,2}")
new_digs
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohsix_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
View(ohsix_pot_dat)
ohsix_pot_dat[grep("tidbit  20", ohsix_pot_dat$Pot.Comment, ignore.case = TRUE), ]
ohsix_pot_dat[grep("tidbit  20", ohsix_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "20"
ohsix_pot_dat[grep("tidbit  13", ohsix_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "13"
ohsix_pot_dat[grep("Tidibt 24", ohsix_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "24"
# Alright, verify we did a good job here
is.na(ohsix_pot_dat$tidbit_id)
# Alright, verify we did a good job here
ohsix_pot_dat[is.na(ohsix_pot_dat$tidbit_id), ]
ohseven_pot_dat <- pot_dat %>%
filter(Year == 2007)
View(ohseven_pot_dat)
# We'll start with an edge case - some Tidbits aren't 1-2 digits - they're 4, with a dash between the first and last set.
# Let's extract those now
ohseven_pot_dat$tidbit_id <- str_extract(ohseven_pot_dat$Pot.Comment, "#\\d{2}-\\d{2}")
# We'll start with an edge case - some Tidbits aren't 1-2 digits - they're 4, with a dash between the first and last set.
# Let's extract those now
ohseven_pot_dat$tidbit_id <- str_extract(ohseven_pot_dat$Pot.Comment, "#\\d{2}-\\d{2}")
# We'll add in all Tidbits after a # (no space)
ohseven_pot_dat$tidbit_id <- str_extract(ohseven_pot_dat$Pot.Comment, "#\\d{1,2}")
View(ohsix_pot_dat)
# For most, the tidbit number is after an "#", so we'll just extract that.
ohsix_pot_dat$tidbit_id <- str_extract(ohsix_pot_dat$Pot.Comment, "bit #\\d{1,2}")
# We'll add in all Tidbits after a # (no space)
ohseven_pot_dat$tidbit_id <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit #\\d{1,2}")
# We'll add in all Tidbits after a # (no space)
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit #\\d{1,2}")
ohseven_pot_dat <- pot_dat %>%
filter(Year == 2007)
# We'll add in all Tidbits after a # (no space)
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit #\\d{1,2}")
new_digs <- str_extract(new_digs, "#\\d{1,2}")
ohseven_pot_dat$tidbit_id <- new_digs
ohseven_pot_dat <- pot_dat %>%
filter(Year == 2007)
# We'll add in all Tidbits after a # (no space)
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit #\\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
ohseven_pot_dat$tidbit_id <- new_digs
# Now an edge case - some Tidbits are four digits, with a dash between the first and last set. Let's extract those.
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "#\\d{2}-\\d{2}")
# Now an edge case - some Tidbits are four digits, with a dash between the first and last set. Let's extract those.
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "#\\d{2}-\\d{2}")
new_digs
# Now an edge case - some Tidbits are four digits, with a dash between the first and last set. Let's extract those.
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "\\d{2}-\\d{2}")
new_digs
# Now an edge case - some Tidbits are four digits, with a dash between the first and last set. For all, the last two digits are 07. Let's extract those.
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "\\d{2}-07")
new_digs
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
View(ohseven_pot_dat)
# Some Tidbit IDs didn't have the # (ex: Tidbit 19, not Tidbit #19), we'll add those too
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit \\d{1,2}")
new_digs
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Now an edge case - some Tidbits are four digits, with a dash between the first and last set. For all, the last two digits are 07. Let's extract those.
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "\\d{2}.07")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Replace last 3 digits (either " 07", "-07", or "_07") with "-07"
new_digs <- str_replace(new_digs, ".07", "-07")
new_digs
# Now an edge case - some Tidbits are four digits, with a dash, space, or underscore between the first and last set. For all, the last two digits are 07. Let's extract those.
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "\\d{2}.07")
# Replace last 3 digits (either " 07", "-07", or "_07") with "-07"
new_digs <- str_replace(new_digs, ".07", "-07")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Some Tidbit IDs didn't have the # (ex: Tidbit 19, not Tidbit #19), we'll add those too
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
ohseven_pot_dat <- pot_dat %>%
filter(Year == 2007)
# We'll add in all Tidbits after a # (no space)
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit #\\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
ohseven_pot_dat$tidbit_id <- new_digs
# Some Tidbit IDs didn't have the # (ex: Tidbit 19, not Tidbit #19), we'll add those too
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Now an edge case - some Tidbits are four digits, with a dash, space, or underscore between the first and last set. For all, the last two digits are 07. Let's extract those.
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "\\d{2}.07")
# Replace last 3 digits (either " 07", "-07", or "_07") with "-07"
new_digs <- str_replace(new_digs, ".07", "-07")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, ignore.case("TB \\d{1,2}"))
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "TB \\d{1,2}")
new_digs
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "TB \\d{1,2}")
new_digs <- str_replace(new_digs, "\\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
ohseven_pot_dat <- pot_dat %>%
filter(Year == 2007)
# We'll add in all Tidbits after a # (no space)
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit #\\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
ohseven_pot_dat$tidbit_id <- new_digs
# Some Tidbit IDs didn't have the # (ex: Tidbit 19, not Tidbit #19), we'll add those too
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "idbit \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "TB \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "tb \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Now an edge case - some Tidbits are four digits, with a dash, space, or underscore between the first and last set. For all, the last two digits are 07. Let's extract those.
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "\\d{2}.07")
# Replace last 3 digits (either " 07", "-07", or "_07") with "-07"
new_digs <- str_replace(new_digs, ".07", "-07")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# We also have a few Tidbits where it's four digits ending in 07 (ex: 2007, not 20-07. We'll convert those too.)
new_digs <- str_extract(ohseven_pot_dat$Pot.Comment, "\\d{2}07")
new_digs
# Replace last 3 digits (either " 07", "-07", or "_07") with "07"
new_digs <- str_replace(new_digs, "07", "-07")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohseven_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# We still have a few left, but we can just add these manually
ohseven_pot_dat[grep("tb  03", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "03"
ohseven_pot_dat[grep("tibit 11", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "11"
ohseven_pot_dat[grep("Tidbit  11", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "11"
ohseven_pot_dat[grep("Tidbit # 25", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "25"
# Alright, verify we did a good job here
ohseven_pot_dat[is.na(ohseven_pot_dat$tidbit_id), ]
ohseven_pot_dat[grep("TB 17.-07", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "17-07"
ohseven_pot_dat[grep("TB 2-07", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "2"
ohseven_pot_dat[grep("TB 2-07", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "2"
ohseven_pot_dat[grep("TB 2-07", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]
ohseven_pot_dat[grep("TB 2-07", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "2-07"
ohseven_pot_dat[grep("TB 2-07", ohseven_pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- "02-07"
View(full_pot_dat)
View(full_pot_dat)
# Create version of pot_dat that only has years with tidbit_id info
full_pot_dat <- pot_dat %>%
filter(Year >= 2008)
View(full_pot_dat)
oheight_pot_dat <- pot_dat %>%
filter(Year == 2008)
View(oheight_pot_dat)
# We'll add in all Tidbits after a # (no space)
new_digs <- str_extract(oheight_pot_dat$Pot.Comment, "idbit #\\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
oheight_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# We'll add in all Tidbits after a # (no space)
new_digs <- str_extract(oheight_pot_dat$Pot.Comment, "#\\d{1,2}")
oheight_pot_dat <- pot_dat %>%
filter(Year == 2008)
# We'll add in all Tidbits after a # (no space)
new_digs <- str_extract(oheight_pot_dat$Pot.Comment, "#\\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
oheight_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Instead of being prefaced with "Tidbit", some are prefaced with "TB" or "tb" (ex: TB 14)
new_digs <- str_extract(oheight_pot_dat$Pot.Comment, "TB \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
oheight_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
new_digs <- str_extract(oheight_pot_dat$Pot.Comment, "tb \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
oheight_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Sometimes there's no space between the TB and the number (all these are capitalized). Let's fix
new_digs <- str_extract(oheight_pot_dat$Pot.Comment, "TB\\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
oheight_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Now an edge case - some Tidbits are four digits, with a dash, space, or underscore between the first and last set. For all, the last two digits are 07. Let's extract those.
new_digs <- str_extract(oheight_pot_dat$Pot.Comment, "\\d{2}.07")
new_digs
# Replace last 3 digits (either " 07", "-07", or "_07") with "07"
new_digs <- str_replace(new_digs, ".07", "-07")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
oheight_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# We also have a few Tidbits where it's four digits ending in 07 (ex: 2007, not 20-07. We'll convert those too.)
new_digs <- str_extract(oheight_pot_dat$Pot.Comment, "\\d{2}07")
new_digs
# Replace last 3 digits (either " 07", "-07", or "_07") with "07"
new_digs <- str_replace(new_digs, "07", "-07")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
oheight_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
test_pot_dat <- rbind(ohfive_pot_dat, ohsix_pot_dat, ohseven_pot_dat, oheight_pot_dat, full_pot_dat)
View(full_pot_dat)
# Create version of pot_dat that only has years with tidbit_id info
full_pot_dat <- pot_dat %>%
filter(Year >= 2009)
test_pot_dat <- rbind(ohfive_pot_dat, ohsix_pot_dat, ohseven_pot_dat, oheight_pot_dat, full_pot_dat)
pot_dat <- rbind(ohfive_pot_dat, ohsix_pot_dat, ohseven_pot_dat, oheight_pot_dat, full_pot_dat)
?filter
# Check other year comments for tidbit ID
pot_dat %>%
filter("tidbit" %in% Pot.Comment)
# Check other year comments for tidbit ID
tidbit_pots <- pot_dat %>%
filter(grepl("Tidbit", Pot.Comment, ignore.case = TRUE))
View(tidbit_pots)
# Check other year comments for tidbit ID
tidbit_pots <- pot_dat %>%
filter(grepl("Tidbit", Pot.Comment, ignore.case = TRUE)) %>%
filter(Year > 2008)
View(tidbit_pots)
# Alright, we've got a few notable commments, but almost none! Let's make some manual corrections
pot_dat[grep("no tidbit", pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- NA
# Alright, we've got a few notable commments, but almost none!
# Some tidbits are listed as missing, but have tidbit numbers in tidbit_id
# Others don't have a value in tidbit_id, but are listed in the comments
# Let's make some manual corrections
pot_dat[grep("no tidbit", pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- NA
pot_dat[grep("tidbit missing", pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- NA
pot_dat[grep("Pot open, no sample, Tidbit broken", pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- NA
pot_dat[grep("tidbit 10", pot_dat$Pot.Comment, ignore.case = TRUE), ]$tidbit_id <- 10
# Check other year comments for tidbit ID
tidbit_pots <- pot_dat %>%
filter(grepl("Tidbit", Pot.Comment, ignore.case = TRUE)) %>%
filter(Year > 2008)
# Let's also check about values labeled "tb"
tidbit_pots <- pot_dat %>%
filter(grepl("TB", Pot.Comment, ignore.case = TRUE)) %>%
filter(Year > 2008)
oheight_pot_dat <- pot_dat %>%
filter(Year == 2009)
View(oheight_pot_dat)
View(tidbit_pots)
ohnine_pot_dat <- pot_dat %>%
filter(Year == 2009)
View(ohnine_pot_dat)
pot_dat <- pot_dat %>%
filter(Year != 2009)
new_digs <- str_extract(ohnine$Pot.Comment, "TB \\d{1,2}")
new_digs <- str_extract(ohnine_pot_dat$Pot.Comment, "TB \\d{1,2}")
new_digs <- str_extract(new_digs, "\\d{1,2}")
for (i in 1:length(new_digs)){
if (!is.na(new_digs[i])) {
ohnine_pot_dat$tidbit_id[i] <- new_digs[i]
}
}
# Re-merge 2009 data in
pot_dat <- rbind(ohnine_pot_dat, pot_dat)
View(pot_dat)
test <- pot_dat %>%
filter(Year > 2009)
View(test)
# None found! We can safely remove the comments column
pot_dat <- pot_dat %>%
select(-Pot.Comment)
View(pot_dat)
